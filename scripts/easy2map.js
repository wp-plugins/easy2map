jQuery(function(){easy2map_functions.initialise_all_easy2maps()});var easy2map_functions=(function(){var b=[];var a;ajax_location=function(c){var d=c.split("_");var e=d[d.length-1];return jQuery("#easy2map_ajax_url_"+e).val()};insertNewMapPoint=function(g,k){var f=new google.maps.Marker({position:new google.maps.LatLng(g.lattitude,g.longitude),draggable:false,map:k,title:g.title.replace(/\\/gi,""),ID:g.ID,icon:g.icon,pinHTML:g.pinHTML});b.push(f);var h=jQuery.xml2json(g.settings);var d=1;var i="";if(h.load&&h.load!=""){d=parseInt(h.load)}if(h.url&&h.url!=""&&h.url!="http://"){i=h.url}try{var c='<p id="e2mpopuphook">'+decodeURIComponent(f.pinHTML)+"</p>"}catch(j){var c='<p id="e2mpopuphook">'+f.pinHTML+"</p>"}if(d===1||(d===3&&i==="")){google.maps.event.addListener(f,"click",function(e){if(a){a.close()}a=new google.maps.InfoWindow();a.setContent(c);a.open(f.map,f);google.maps.event.addListener(a,"domready",function(){try{var m=jQuery("#e2mpopuphook").parent().parent().parent().siblings();for(var n=0;n<m.length;n++){if(jQuery(m[n]).css("z-index")=="auto"){jQuery(m[n]).css("border-radius","7px")}}}catch(o){}})})}if(d===2){if(a){a.close()}a=new google.maps.InfoWindow();a.setContent(c);a.open(f.map,f)}if(d===3&&i!=""){google.maps.event.addListener(f,"click",function(e){window.location.href=i})}return f};replaceAll=function(d,c,f){var e=d.indexOf(c);while(e!=-1){d=replaceChars(d,e,c.length,f);e=d.indexOf(c)}return d};replaceChars=function(c,f,d,e){if(f<0){f=0}if(f>=c.length){f=c.length-1}if(d<0){d=0}if(d>c.length){d=c.length}return(c.substring(0,f)+e+c.substring(f+d))};retrieve_map_pins=function(h,g,d,j,i){var f=g.split("_");var c=f[f.length-1];var e={action:"retrieve_map_points",MapID:c,maxPins:d};jQuery.ajax({type:"POST",url:ajax_location(g),data:e,dataType:"json",success:function(o){if(typeof o=="undefined"||typeof o=="null"){return}if(!o){return}if(o.length==0){return}for(var n=0;n<o.length;n++){var p=replaceAll(replaceAll(replaceAll(o[n].LatLong," ",""),"(",""),")","").split(",");var l={lattitude:p[0],longitude:p[1],title:o[n].Title,ID:o[n].ID,icon:o[n].ImageURL,settings:o[n].Settings,pinHTML:o[n].MapPinHTML};j.push(l)}var k=[];for(var m=0;m<j.length;m++){k.push(insertNewMapPoint(j[m],h))}}})};retrieve_map_settings=function(f){var e;var g=[];var d=f.split("_");var c=d[d.length-1];jQuery.ajax({type:"POST",url:ajax_location(f),dataType:"json",data:{mapID:c,action:"retrieve_map_settings"},success:function(k){var v=jQuery.xml2json(k.Settings);var j=v.lattitude;var l=v.longitude;var u=parseInt(v.zoom);var s=new google.maps.LatLng(j,l);var r=v.mapType.toUpperCase();var q=v.mapTypeControl_style.toUpperCase();var w=v.mapTypeControl_position.toUpperCase();var t=v.zoomControl_style.toUpperCase();var n=v.zoomControl_position.toUpperCase();var o=v.zoomControl_position.toUpperCase();if(r==="ROADMAP"){r=google.maps.MapTypeId.ROADMAP}else{if(r==="HYBRID"){r=google.maps.MapTypeId.HYBRID}else{if(r==="SATELLITE"){r=google.maps.MapTypeId.SATELLITE}else{if(r==="TERRAIN"){r=google.maps.MapTypeId.TERRAIN}else{r=google.maps.MapTypeId.ROADMAP}}}}if(q==="DEFAULT"){q=google.maps.MapTypeControlStyle.DEFAULT}else{if(q==="DROPDOWN_MENU"){q=google.maps.MapTypeControlStyle.DROPDOWN_MENU}else{if(q==="SATELLITE"){q=google.maps.MapTypeControlStyle.SATELLITE}else{q=google.maps.MapTypeControlStyle.DEFAULT}}}if(w==="TOP_LEFT"){w=google.maps.ControlPosition.TOP_LEFT}else{if(w==="TOP_RIGHT"){w=google.maps.ControlPosition.TOP_RIGHT}else{if(w==="TOP_CENTER"){w=google.maps.ControlPosition.TOP_CENTER}else{w=google.maps.ControlPosition.TOP_RIGHT}}}if(t==="DEFAULT"){t=google.maps.ZoomControlStyle.DEFAULT}else{if(t==="LARGE"){t=google.maps.ZoomControlStyle.LARGE}else{t=google.maps.ZoomControlStyle.SMALL}}if(n==="TOP_LEFT"){n=google.maps.ControlPosition.TOP_LEFT}else{if(n==="TOP_RIGHT"){n=google.maps.ControlPosition.TOP_RIGHT}else{if(n==="TOP_CENTER"){n=google.maps.ControlPosition.TOP_CENTER}else{n=google.maps.ControlPosition.TOP_RIGHT}}}if(o==="TOP_LEFT"){o=google.maps.ControlPosition.TOP_LEFT}else{if(o==="TOP_RIGHT"){o=google.maps.ControlPosition.TOP_RIGHT}else{if(o==="TOP_CENTER"){o=google.maps.ControlPosition.TOP_CENTER}else{o=google.maps.ControlPosition.TOP_RIGHT}}}var i={zoom:u,center:s,mapTypeId:r,mapTypeControl:!!parseInt(v.mapTypeControl),mapTypeControlOptions:{style:q,position:w},zoomControl:!!parseInt(v.zoomControl),navigationControl:true,zoomControlOptions:{style:t,position:n},scaleControl:!!parseInt(v.scaleControl),scaleControlOptions:{position:o},streetViewControl:!!parseInt(v.streetViewControl),panControl:!!parseInt(v.panControl),draggable:!!parseInt(v.draggable)};e=new google.maps.Map(document.getElementById(f),i);if(!!parseInt(v.trafficlayer)){var h=new google.maps.TrafficLayer();h.setMap(e)}if(!!parseInt(v.transitlayer)){var p=new google.maps.TransitLayer();p.setMap(e)}if(!!parseInt(v.bicyclelayer)){var m=new google.maps.BicyclingLayer();m.setMap(e)}google.maps.event.addDomListener(window,"load",retrieve_map_pins(e,f,250,g,v))}})};return{displayPinItem:function(c){for(var d=0;d<b.length;d++){if(b[d].ID){if(parseInt(b[d].ID)===c){google.maps.event.trigger(b[d],"click");return}}}},initialise_all_easy2maps:function(){jQuery("div [id ^= easy2map_canvas_]").each(function(){var c=jQuery(this).attr("id");retrieve_map_settings(c)})}}})();